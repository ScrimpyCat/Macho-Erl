Macho-Erl
=========

A Mach-O parser for Erlang.

This is currently a work in progress, as it doesn't parse all of the data just yet.

An example result of parsing the Foundation.framework: macho:parse("/System/Library/Frameworks/Foundation.framework/Versions/C/Foundation").
	
	{fat,
	    [{mach_header_64,little,
	         {cpu_type_x86_64,cpu_subtype_x86_64_all,[]},
	         dylib,
	         [{segment_command_64,
	              <<"__TEXT",0,0,0,0,0,0,0,0,0,0>>,
	              {vm,0,3141632},
	              {file,0,3141632},
	              {prot,7,5},
	              17,[]},
	          {segment_command_64,
	              <<"__DATA",0,0,0,0,0,0,0,0,0,0>>,
	              {vm,3141632,786432},
	              {file,3141632,778240},
	              {prot,7,3},
	              21,[]},
	          {segment_command_64,
	              <<"__LINKEDIT",0,0,0,0,0,0>>,
	              {vm,3928064,1556480},
	              {file,3919872,1555504},
	              {prot,7,1},
	              0,[]},
	          {dylib_command,id_dylib,
	              <<"/System/Library/Frameworks/Foundation.framework/Versions/C/Foundation",0,0,0>>,
	              1,
	              {1056,13,0},
	              {300,0,0}},
	          {required,
	              {dyld_info_command,
	                  {rebase,3919872,17512},
	                  {bind,3937384,11952},
	                  {weak_bind,0,0},
	                  {lazy_bind,3949336,53304},
	                  {export,4002640,40864}}},
	          {symtab_command,{sym,4193672,21928},{str,4558952,883976}},
	          {dysymtab_command,
	              {local_sym,0,18446},
	              {ext_def_sym,18446,1511},
	              {undef_sym,19957,1971},
	              {toc,0,0},
	              {mod_tab,0,0},
	              {ext_ref_sym,0,0},
	              {indrect_sym,4544520,3608},
	              {ext_rel,0,0},
	              {loc_rel,0,0}},
	          {uuid_command,
	              <<46,233,171,7,62,160,55,211,180,7,74,82,15,44,180,151>>},
	          {version_min_macosx_command,{10,9,0},{10,9,0}},
	          {source_version_command,{1056,768,4,0,0}},
	          {linkedit_data_command,segment_split_info,{data,4043504,130000}},
	          {dylib_command,load_dylib,
	              <<"/usr/lib/libauto.dylib",0,0>>,
	              2,
	              {1,0,0},
	              {1,0,0}},
	          {dylib_command,load_dylib,
	              <<"/usr/lib/libDiagnosticMessagesClient.dylib",0,0,0,0,0,0>>,
	              2,
	              {1,0,0},
	              {1,0,0}},
	          {dylib_command,load_dylib,
	              <<"/usr/lib/libicucore.A.dylib",0,0,0,0,0>>,
	              2,
	              {51,1,0},
	              {1,0,0}},
	          {required,
	              {dylib_command,reexport_dylib,
	                  <<"/usr/lib/libobjc.A.dylib",0,0,0,0,0,0,0,0>>,
	                  2,
	                  {228,0,0},
	                  {1,0,0}}},
	          {dylib_command,load_dylib,
	              <<"/usr/lib/libxml2.2.dylib",0,0,0,0,0,0,0,0>>,
	              2,
	              {10,9,0},
	              {10,0,0}},
	          {dylib_command,load_dylib,
	              <<"/usr/lib/libz.1.dylib",0,0,0>>,
	              2,
	              {1,2,5},
	              {1,0,0}},
	          {required,
	              {dylib_command,reexport_dylib,
	                  <<"/System/Library/Frameworks/CoreFoundation.framework/Versions/A/CoreFoundation",0,0,0>>,
	                  2,
	                  {855,14,0},
	                  {150,0,0}}},
	          {dylib_command,load_dylib,
	              <<"/System/Library/Frameworks/CFNetwork.framework/Versions/A/CFNetwork",0,0,0,0,0>>,
	              2,
	              {673,2,0},
	              {1,0,0}},
	          {dylib_command,load_dylib,
	              <<"/System/Library/Frameworks/SystemConfiguration.framework/Versions/A/SystemConfiguration",0>>,
	              2,
	              {596,13,0},
	              {1,0,0}},
	          {dylib_command,load_dylib,
	              <<"/System/Library/Frameworks/Security.framework/Versions/A/Security",0,0,0,0,0,0,0>>,
	              2,
	              {55471,6,0},
	              {1,0,0}},
	          {dylib_command,load_dylib,
	              <<"/System/Library/Frameworks/CoreServices.framework/Versions/A/CoreServices",0,0,0,0,0,0,0>>,
	              2,
	              {59,0,0},
	              {1,0,0}},
	          {dylib_command,load_dylib,
	              <<"/usr/lib/liblangid.dylib",0,0,0,0,0,0,0,0>>,
	              2,
	              {1,0,0},
	              {1,0,0}},
	          {dylib_command,load_dylib,
	              <<"/System/Library/Frameworks/IOKit.framework/Versions/A/IOKit",0,0,0,0,0>>,
	              2,
	              {275,0,0},
	              {1,0,0}},
	          {dylib_command,load_dylib,
	              <<"/usr/lib/libCRFSuite.dylib",0,0,0,0,0,0>>,
	              2,
	              {1,0,0},
	              {1,0,0}},
	          {dylib_command,load_dylib,
	              <<"/usr/lib/libSystem.B.dylib",0,0,0,0,0,0>>,
	              2,
	              {1197,1,1},
	              {1,0,0}},
	          {linkedit_data_command,function_starts,{data,4173504,19296}},
	          {linkedit_data_command,data_in_code,{data,4192800,0}},
	          {linkedit_data_command,dylib_code_sign_drs,{data,4192800,872}},
	          {linkedit_data_command,code_signature,{data,5442928,32448}}],
	         [noundefs,dyldlink,twolevel]},
	     {mach_header,little,
	         {cpu_type_x86,cpu_subtype_x86_all,[]},
	         dylib,
	         [{segment_command,
	              <<"__TEXT",0,0,0,0,0,0,0,0,0,0>>,
	              {vm,0,3325952},
	              {file,0,3325952},
	              {prot,7,5},
	              13,[]},
	          {segment_command,
	              <<"__DATA",0,0,0,0,0,0,0,0,0,0>>,
	              {vm,3325952,126976},
	              {file,3325952,122880},
	              {prot,7,3},
	              7,[]},
	          {segment_command,
	              <<"__OBJC",0,0,0,0,0,0,0,0,0,0>>,
	              {vm,3452928,274432},
	              {file,3448832,274432},
	              {prot,7,3},
	              16,[]},
	          {segment_command,
	              <<"__LINKEDIT",0,0,0,0,0,0>>,
	              {vm,3727360,1265664},
	              {file,3723264,1261712},
	              {prot,7,1},
	              0,[]},
	          {dylib_command,id_dylib,
	              <<"/System/Library/Frameworks/Foundation.framework/Versions/C/Foundation",0,0,0>>,
	              1,
	              {1056,13,0},
	              {300,0,0}},
	          {required,
	              {dyld_info_command,
	                  {rebase,3723264,17920},
	                  {bind,3741184,8016},
	                  {weak_bind,0,0},
	                  {lazy_bind,3749200,53916},
	                  {export,3803116,37444}}},
	          {symtab_command,{sym,3940576,19316},{str,4187492,767400}},
	          {dysymtab_command,
	              {local_sym,0,15968},
	              {ext_def_sym,15968,1399},
	              {undef_sym,17367,1949},
	              {toc,0,0},
	              {mod_tab,0,0},
	              {ext_ref_sym,0,0},
	              {indrect_sym,4172368,3781},
	              {ext_rel,0,0},
	              {loc_rel,0,0}},
	          {uuid_command,
	              <<195,58,137,132,126,151,54,190,184,66,238,79,227,95,83,234>>},
	          {version_min_macosx_command,{10,9,0},{10,9,0}},
	          {source_version_command,{1056,768,4,0,0}},
	          {linkedit_data_command,segment_split_info,{data,3840560,79684}},
	          {dylib_command,load_dylib,
	              <<"/usr/lib/libauto.dylib",0,0>>,
	              2,
	              {1,0,0},
	              {1,0,0}},
	          {dylib_command,load_dylib,
	              <<"/usr/lib/libDiagnosticMessagesClient.dylib",0,0>>,
	              2,
	              {1,0,0},
	              {1,0,0}},
	          {dylib_command,load_dylib,
	              <<"/usr/lib/libicucore.A.dylib",0>>,
	              2,
	              {51,1,0},
	              {1,0,0}},
	          {required,
	              {dylib_command,reexport_dylib,
	                  <<"/usr/lib/libobjc.A.dylib",0,0,0,0>>,
	                  2,
	                  {228,0,0},
	                  {1,0,0}}},
	          {dylib_command,load_dylib,
	              <<"/usr/lib/libxml2.2.dylib",0,0,0,0>>,
	              2,
	              {10,9,0},
	              {10,0,0}},
	          {dylib_command,load_dylib,
	              <<"/usr/lib/libz.1.dylib",0,0,0>>,
	              2,
	              {1,2,5},
	              {1,0,0}},
	          {required,
	              {dylib_command,reexport_dylib,
	                  <<"/System/Library/Frameworks/CoreFoundation.framework/Versions/A/CoreFoundation",0,0,0>>,
	                  2,
	                  {855,14,0},
	                  {150,0,0}}},
	          {dylib_command,load_dylib,
	              <<"/System/Library/Frameworks/CFNetwork.framework/Versions/A/CFNetwork",0>>,
	              2,
	              {673,2,0},
	              {1,0,0}},
	          {dylib_command,load_dylib,
	              <<"/System/Library/Frameworks/SystemConfiguration.framework/Versions/A/SystemConfiguration",0>>,
	              2,
	              {596,13,0},
	              {1,0,0}},
	          {dylib_command,load_dylib,
	              <<"/System/Library/Frameworks/Security.framework/Versions/A/Security",0,0,0>>,
	              2,
	              {55471,6,0},
	              {1,0,0}},
	          {dylib_command,load_dylib,
	              <<"/System/Library/Frameworks/CoreServices.framework/Versions/A/CoreServices",0,0,0>>,
	              2,
	              {59,0,0},
	              {1,0,0}},
	          {dylib_command,load_dylib,
	              <<"/usr/lib/liblangid.dylib",0,0,0,0>>,
	              2,
	              {1,0,0},
	              {1,0,0}},
	          {dylib_command,load_dylib,
	              <<"/System/Library/Frameworks/IOKit.framework/Versions/A/IOKit",0>>,
	              2,
	              {275,0,0},
	              {1,0,0}},
	          {dylib_command,load_dylib,
	              <<"/usr/lib/libCRFSuite.dylib",0,0>>,
	              2,
	              {1,0,0},
	              {1,0,0}},
	          {dylib_command,load_dylib,
	              <<"/usr/lib/libSystem.B.dylib",0,0>>,
	              2,
	              {1197,1,1},
	              {1,0,0}},
	          {linkedit_data_command,function_starts,{data,3920244,19464}},
	          {linkedit_data_command,data_in_code,{data,3939708,0}},
	          {linkedit_data_command,dylib_code_sign_drs,{data,3939708,868}},
	          {linkedit_data_command,code_signature,{data,4954896,30080}}],
	         [noundefs,dyldlink,twolevel]}]}